# Threat Analyzer Configuration

# Loki Configuration
LOKI_URL = "http://loki:3100"
LOKI_QUERY = '{app="coraza"} | json'

# Cilium Configuration
CILIUM_URL = "http://cilium-operator:9963"

# Attack Detection Settings
ATTACK_THRESHOLD = 3  # Number of attacks before blocking an IP
BLOCK_DURATION_HOURS = 24  # How long to block an IP (in hours)
TIME_WINDOW_MINUTES = 10  # Time window to count attacks (in minutes)

# Logging
LOG_LEVEL = "INFO"
LOG_FILE = "/var/log/threat-analyzer.log"

# Network Policy Settings
BLOCKED_NAMESPACE = "default"  # Namespace to apply blocking policies
POLICY_LABELS = {
    "auto-generated": "true",
    "managed-by": "threat-analyzer"
}

# Additional filters (optional)
IGNORE_INTERNAL_IPS = True  # Whether to ignore internal/private IPs
TRUSTED_IP_RANGES = ["10.0.0.0/8", "172.16.0.0/12", "192.168.0.0/16"]  # Don't block these ranges

# Debug mode
DEBUG = False